<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Leslie Hodges Gallagher, Ph.D.&nbsp;‚Äì Leslie Hodges Gallagher CV</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
.display.math{display: block; text-align: center; margin: 0.5rem auto;}
</style>


<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html-5276476b5bdb9cfe1f92c505466e0bf3.min.css" rel="stylesheet" append-hash="true" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">


<link rel="stylesheet" href="styles.css">
</head>

<body>


<header id="title-block-header">
<h1 class="title">Leslie Hodges Gallagher, Ph.D.</h1>

</header>


<div class="print-only">
<div class="name-header">
<p>Leslie Hodges Gallagher, Ph.D.</p>
</div>
<p><strong>Email:</strong> hodges.gallagher@gmail.com <span class="pipe">|</span> <strong>Phone:</strong> <span class="pipe">|</span> <strong>Location:</strong> San Francisco Bay Area <span class="pipe">|</span> <strong>Website:</strong> <a href="https://linkedin.com/in/leslie-hodges-gallagher">LinkedIn</a> <span class="pipe">|</span> <strong>ORCID:</strong><a href="https://orcid.org/0009-0005-9425-8380">0009-0005-9425-8380</a></p>
</div>
<div class="no-print">
<p><strong>Email:</strong> <a href="mailto:hodges.gallagher@gmail.com">hodges.gallagher@gmail.com</a> <span class="pipe">|</span> <strong>Location:</strong> San Francisco Bay Area <span class="pipe">|</span> <strong>Website:</strong> <a href="https://linkedin.com/in/leslie-hodges-gallagher">LinkedIn</a> <span class="pipe">|</span> <strong>ORCID:</strong> <a href="https://orcid.org/0009-0005-9425-8380">0009-0005-9425-8380</a><br>
<a href="./HodgesGallagher_CV_20250713.pdf" class="pdf-button-small">üìÑ Download PDF</a></p>
</div>
<h2 id="summary" class="anchored">SUMMARY</h2>
<p>Molecular cancer biologist with 20+ years experience in preclinical oncology R&amp;D, spanning from startup to post-IPO companies. Skilled in building high-performing teams, designing preclinical strategies to de-risk early drug discovery, and advancing small-molecule programs from discovery to IND. Hands-on leader passionate about working with innovative cross-functional teams at the forefront of next-generation cancer therapeutics.</p>
<h2 id="experience" class="anchored">EXPERIENCE</h2>
<h3 id="independent-consultant" class="anchored">INDEPENDENT CONSULTANT</h3>
<ul>
<li><strong>Black Shadow Therapeutics</strong> <span class="pipe">|</span> San Francisco, CA <span class="pipe">|</span> 2023‚Äìpresent
<ul>
<li>Advised team on laboratory startup and establishing small molecule screening program</li>
<li>Key role in preclinical model development to advance lead candidates<br>
</li>
<li>Co-inventor on provisional patent application</li>
</ul></li>
</ul>
<h3 id="olema-pharmaceuticals" class="anchored">OLEMA PHARMACEUTICALS</h3>
<p><strong>Sr.&nbsp;Vice President, Sr.&nbsp;Principal Scientist, Director of Molecular Biology</strong> <span class="pipe">|</span> San Francisco <span class="pipe">|</span> 2007‚Äì2023</p>
<ul>
<li>First hire and key contributor to the team that advanced the company from startup through IPO, with a lead candidate to treat hormone-responsive breast cancer now in Phase 3 clinical trials</li>
<li>20+ years supervisory and mentorship experience</li>
<li>Project functional co-lead, coordinating efforts across internal teams, executive leadership, scientific advisory board, and external collaborators</li>
<li>Established and managed multiple laboratories, overseeing equipment procurement and maintenance, sample storage systems, vendor relationships, budget tracking, training, and biosafety compliance</li>
<li>Developed and optimized multiple novel cell-based bioassays to predict preclinical efficacy, supporting the advancement of a small molecule to IND</li>
<li>Established automation program for hit-to-lead HTS, enabling pipeline expansion with a second small molecule oncology target</li>
<li>Co-inventor on 9 patent applications and co-author of 3 peer-reviewed manuscripts</li>
</ul>
<h3 id="postdoctoral-fellow" class="anchored">POSTDOCTORAL FELLOW</h3>
<p><strong>University of California San Francisco, Department of Medicine</strong> <span class="pipe">|</span> San Francisco, CA <span class="pipe">|</span> 2002‚Äì2007<br>
- Mentor: Peter J. Kushner, Ph.D.<br>
- Research focus on designing novel strategies to enhance the efficacy of endocrine therapies for breast cancer</p>
<h3 id="graduate-research-assistant" class="anchored">GRADUATE RESEARCH ASSISTANT</h3>
<p><strong>University of Texas M.D.&nbsp;Anderson Cancer Center</strong> <span class="pipe">|</span> Smithville, TX <span class="pipe">|</span> 1996‚Äì2002<br>
- Mentor: Cheryl L. Walker, Ph.D.<br>
- Thesis title: <em>Critical Determinants of Estrogen Receptor Agonist Activity</em></p>
<h2 id="education" class="anchored">EDUCATION</h2>
<h4 id="ph.d.-university-of-texas-graduate-school-of-biomedical-sciences" class="anchored">Ph.D., University of Texas Graduate School of Biomedical Sciences</h4>
<h4 id="b.a.-university-of-texas-at-austin" class="anchored">B.A., University of Texas at Austin</h4>
<h2 id="publications" class="anchored">PUBLICATIONS</h2>
<p>Ng RA, Barratt S, Parisian A, Palanisamy GS, Phukan S, Sun R, Robello B, Pe√±a G, Sapugay J, Yeghikyan D, Wang C, Satish Kher S, Thangathirupathy S, Millikin R, Yu G, Watanabe T, Zhou F, Rich B, Duncan A, Andersen SE, Chawla R, Zak DR, Heerding DA, Hearn BR, Greene G, Harmon CL, <strong>Hodges-Gallagher L</strong>, Kushner PJ, Fanning SW, Myles DC. ‚ÄúDiscovery of Palazestrant (OP-1250), a Potent and Orally Bioavailable Complete Estrogen Receptor Antagonist (CERAN) and Selective Estrogen Receptor Degrader (SERD).‚Äù <em>ACS Omega</em>, 2025;10(22):22685-22700. <a href="https://doi.org/10.1021/acsomega.4c11023">DOI: 10.1021/acsomega.4c11023</a></p>
<p>Parisian AD, Barratt SA, <strong>Hodges-Gallagher L</strong>, Ortega FE, Pe√±a G, Sapugay J, Robello B, Sun R, Kulp D, Palanisamy GS, Myles DC, Kushner PJ, Harmon CL. ‚ÄúPalazestrant (OP-1250), A Complete Estrogen Receptor Antagonist, Inhibits Wild-type and Mutant ER-positive Breast Cancer Models as Monotherapy and in Combination.‚Äù <em>Mol Cancer Ther</em>, 2024;23(3):285‚Äì300. <a href="https://doi.org/10.1158/1535-7163.MCT-23-0351">DOI: 10.1158/1535-7163.MCT-23-0351</a></p>
<p>(co-first author) Fanning SW, <strong>Hodges-Gallagher L</strong>, Myles DC, Sun R, Fowler CE, Plant IN, Green BD, Harmon CL, Greene GL, Kushner PJ. ‚ÄúSpecific stereochemistry of OP-1074 disrupts estrogen receptor alpha helix 12 and confers pure antiestrogenic activity.‚Äù <em>Nat Commun</em>, 2018;9(1):2368. <a href="https://doi.org/10.1038/s41467-018-04413-3">DOI: 10.1038/s41467-018-04413-3</a></p>
<p><strong>Hodges-Gallagher L</strong>, Valentine CD, El Bader S, Kushner PJ. ‚ÄúEstrogen receptor beta increases the efficacy of antiestrogens by effects on apoptosis and cell cycling in breast cancer cells.‚Äù <em>Breast Cancer Res Treat</em>, 2008;109(2):241-50. <a href="https://doi.org/10.1007/s10549-007-9640-6">DOI: 10.1007/s10549-007-9640-6</a></p>
<p><strong>Hodges-Gallagher L</strong>, Valentine CD, Bader SE, Kushner PJ. ‚ÄúInhibition of histone deacetylase enhances the anti-proliferative action of antiestrogens on breast cancer cells and blocks tamoxifen-induced proliferation of uterine cells.‚Äù <em>Breast Cancer Res Treat</em>, 2007;105(3):297-309. <a href="https://doi.org/10.1007/s10549-006-9459-6">DOI: 10.1007/s10549-006-9459-6</a></p>
<div class="no-print">
<details>
<summary>
<strong>View 11 additional publications</strong>
</summary>
<p>Zavodovskaya M, Campbell MJ, Maddux BA, Shiry L, Allan G, <strong>Hodges L</strong>, Kushner P, Kerner JA, Youngren JF, Goldfine ID. ‚ÄúNordihydroguaiaretic acid (NDGA), an inhibitor of the HER2 and IGF-1 receptor tyrosine kinases, blocks the growth of HER2-overexpressing human breast cancer cells.‚Äù <em>J Cell Biochem</em>, 2008;103(2):624-35. <a href="https://doi.org/10.1002/jcb.21435">DOI: 10.1002/jcb.21435</a></p>
<p><strong>Hodges LC</strong>, Cook JD, Lobenhofer EK, Li L, Bennett L, Bushel PR, Aldaz CM, Afshari CA, Walker CL. ‚ÄúTamoxifen functions as a molecular agonist inducing cell cycle-associated genes in breast cancer cells.‚Äù <em>Mol Cancer Res</em>, 2003;1(4):300-11. <a href="https://pubmed.ncbi.nlm.nih.gov/12612058">PMID: 12612058</a></p>
<p><strong>Hodges LC</strong>, Houston KD, Hunter DS, Fuchs-Young R, Zhang Z, Wineker RC, Walker CL. ‚ÄúTransdominant suppression of estrogen receptor signaling by progesterone receptor ligands in uterine leiomyoma cells.‚Äù <em>Mol Cell Endocrinol</em>, 2002;196(1-2):11-20. <a href="https://doi.org/10.1016/s0303-7207(02)00230-7">DOI: 10.1016/s0303-7207(02)00230-7</a></p>
<p><strong>Hodges LC</strong>, Hunter DS, Bergerson JS, Fuchs-Young R, Walker CL. ‚ÄúAn in vivo/in vitro Model to Assess Endocrine Disrupting Activity of Xenoestrogens in Uterine Leiomyoma.‚Äù <em>Ann N Y Acad Sci</em>, 2001;948:100-111. <a href="https://doi.org/10.1111/j.1749-6632.2001.tb03991.x">DOI: 10.1111/j.1749-6632.2001.tb03991.x</a></p>
<p>Houston KD, Hunter DS, <strong>Hodges LC</strong>, Walker CL. ‚ÄúUterine Leiomyomas: Mechanisms of Tumorigenesis.‚Äù <em>Toxicol Pathol</em>, 2001;29(1):100-104. <a href="https://doi.org/10.1080/019262301301418900">DOI: 10.1080/019262301301418900</a></p>
<p>Hunter DS, <strong>Hodges LC</strong>, Eagon PK, Vonier PM, Fuchs-Young R, Bergerson JS, Walker CL. ‚ÄúInfluence of exogenous estrogen receptor ligands on uterine leiomyoma: evidence from an in vitro/in vivo animal model for uterine fibroids.‚Äù <em>Environ Health Perspect</em>, 2000;108 Suppl 5:829-34. <a href="https://doi.org/10.1289/ehp.00108s5829">DOI: 10.1289/ehp.00108s5829</a></p>
<p><strong>Hodges LC</strong>, Bergerson JS, Hunter DS, Walker CL. ‚ÄúEstrogenic effects of organochlorine pesticides on uterine leiomyoma cells in vitro.‚Äù <em>Toxicol Sci</em>, 2000;54(2):355-64. <a href="https://doi.org/10.1093/toxsci/54.2.355">DOI: 10.1093/toxsci/54.2.355</a></p>
<p>Zenklusen JC, <strong>Hodges LC</strong>, LaCava M, Green ED, Conti CJ. ‚ÄúDefinitive functional evidence for a tumor suppressor gene on human chromosome 7q31.1 neighboring the Fra7G site.‚Äù <em>Oncogene</em>, 2000;19(13):1729-33. <a href="https://doi.org/10.1038/sj.onc.1203488">DOI: 10.1038/sj.onc.1203488</a></p>
<p>Hunter DS, <strong>Hodges LC</strong>, Vonier PM, Fuchs-Young R, Gottardis MM, Walker CL. ‚ÄúEstrogen receptor activation via activation function 2 predicts agonism of xenoestrogens in normal and neoplastic cells of the uterine myometrium.‚Äù <em>Cancer Res</em>, 1999;59(13):3090-9. <a href="https://pubmed.ncbi.nlm.nih.gov/10397250">PMID: 10397250</a></p>
<p>Walker C, Ahmed SA, Brown T, Ho SM, <strong>Hodges L</strong>, Lucier G, Russo J, Weigel N, Weise T, Vandenbergh J. ‚ÄúSpecies, interindividual, and tissue specificity in endocrine signaling.‚Äù <em>Environ Health Perspect</em>, 1999;107 Suppl 4:619-24. <a href="https://pubmed.ncbi.nlm.nih.gov/10421772">PMID: 10421772</a></p>
<p>Zenklusen JC, <strong>Hodges LC</strong>, Conti CJ. ‚ÄúLoss of heterozygosity on murine chromosome 6 in two-stage carcinogenesis: evidence for a conserved tumor suppressor gene.‚Äù <em>Oncogene</em>, 1997;14(1):109-14. <a href="https://doi.org/10.1038/sj.onc.1200806">DOI: 10.1038/sj.onc.1200806</a></p>
</details>
</div>
<div class="print-only">
<p><em>11 additional publications available on request</em></p>
</div>
<h2 id="patents" class="anchored">PATENTS</h2>
<p><strong>Methods of treating estrogen receptor-associated diseases.</strong> Cyrus L. Harmon, Peter J. Kushner, David C. Myles, <strong>Leslie Hodges Gallagher</strong>. <a href="https://patents.google.com/patent/US20230129598A1">US Patent Application 2023129598 A1</a>, published 4/27/2023; <a href="https://patents.google.com/patent/WO2023283329A1">WIPO #WO2023/283329 A1</a>, published 1/12/2023.</p>
<p><strong>Regimens of estrogen receptor antagonists.</strong> Cyrus L. Harmon, Peter J. Kushner, David C. Myles, <strong>Leslie Hodges Gallagher</strong>, Richard Sun. <a href="https://patents.google.com/patent/US20220265616A1">US Patent Application 2022/0265616 A1</a>, published 8/25/2022.</p>
<p><strong>Compositions and methods for regulating immune system activity.</strong> Peter J. Kushner, <strong>Leslie Hodges Gallagher</strong>, Cyrus L. Harmon, David C. Myles, Richard Sun. <a href="https://patents.google.com/patent/US20230159619A1">US Patent Application 2023159619</a>, published 5/25/2023; <a href="https://patents.google.com/patent/WO2018157000A1">WIPO #WO2018/157000 A1</a>, published 8/30/2018.</p>
<p><strong>Benzopyran compounds, compositions and uses thereof.</strong> Peter J. Kushner, David C. Myles, Cyrus L. Harmon, <strong>Leslie Hodges Gallagher</strong>. <a href="https://patents.google.com/patent/US9018244B2">US Patent 9,018,244 B2</a>, granted 4/28/2015.</p>
<p><strong>Substituted benzopyran compounds, compositions and uses thereof.</strong> David C. Myles, Peter J. Kushner, Cyrus L. Harmon, <strong>Leslie Hodges Gallagher</strong>. <a href="https://patents.google.com/patent/WO2014203132A1">WIPO #WO2014/203132 A1</a>, published 12/24/2014.</p>
<div class="no-print">
<details>
<summary>
<strong>View 5 additional patents</strong>
</summary>
<p><strong>Combinations of benzopyran compounds, compositions and uses thereof.</strong> Peter J. Kushner, <strong>Leslie Hodges Gallagher</strong>, Cyrus L. Harmon, David C. Myles. <a href="https://patents.google.com/patent/WO2014203129A1">WIPO #WO/2014/203129 A1</a>, published 12/24/2014.</p>
<p><strong>Anti-estrogenic compounds.</strong> Peter J. Kushner, David C. Myles, Cyrus L. Harmon, <strong>Leslie Hodges Gallagher</strong>. US Patent Application 2017362210 A1, published 12/21/2017 (assigned to Pfizer Inc.).</p>
<p><strong>Small molecule potentiator of hormonal therapy for breast cancer.</strong> Peter Kushner, Ira Goldfine, <strong>Leslie Hodges-Gallagher</strong>, Cathleen Valentine. US Patent Application 2008085874 A1, published 4/10/2008.</p>
<p><strong>Undisclosed provisional application.</strong> Peter J. Kushner, <strong>Leslie Hodges Gallagher</strong>, Brian Rich, Jason Duquette, Richard Sun. USPTO application filed 2025.</p>
<p><strong>Regulated transcription of dominant negative kinase.</strong> Peter J. Kushner, <strong>Leslie Hodges Gallagher</strong>, Cyrus L. Harmon, David C. Myles, Richard Sun. USPTO application filed 2022.</p>
</details>
</div>
<div class="print-only">
<p><em>5 additional patents available on request</em></p>
</div>


<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
  tabsets.forEach(function(tabset) {
    const tabby = new Tabby('#' + tabset.id);
  });
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>




</body></html>